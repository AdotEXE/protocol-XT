# üì¶ –°–∏—Å—Ç–µ–º–∞ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –ú–æ–¥—É–ª–µ–π (Tank Modules Design)

–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç –æ–ø–∏—Å—ã–≤–∞–µ—Ç –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É –∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é —Å–∏—Å—Ç–µ–º—ã –≤–∏–∑—É–∞–ª—å–Ω—ã—Ö –º–æ–¥—É–ª–µ–π –¥–ª—è —Ç–∞–Ω–∫–æ–≤.

---

## üéØ 1. –ö–æ–Ω—Ü–µ–ø—Ü–∏—è
–ú–æ–¥—É–ª–∏ ‚Äî —ç—Ç–æ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º—ã–µ —É–ª—É—á—à–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ:
1.  **–í–∏–¥–Ω—ã –≤–∏–∑—É–∞–ª—å–Ω–æ** –Ω–∞ —Ç–∞–Ω–∫–µ (–∫—Ä–µ–ø—è—Ç—Å—è –Ω–∞ –∫–æ—Ä–ø—É—Å, –±–∞—à–Ω—é, —Å—Ç–≤–æ–ª).
2.  **–ú–µ–Ω—è—é—Ç —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏** (—Å–∫–æ—Ä–æ—Å—Ç—å, –±—Ä–æ–Ω—è, –ø–µ—Ä–µ–∑–∞—Ä—è–¥–∫–∞).
3.  **–î–∞—é—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –º–µ—Ö–∞–Ω–∏–∫–∏** (—Ä–µ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è, –∞–≤—Ç–æ-—Å–ø–æ—Ç, —Å—Ç–µ–ª—Å).

–ò–≥—Ä–æ–∫ —Å–æ–±–∏—Ä–∞–µ—Ç —Å–≤–æ–π –±–∏–ª–¥, –±–∞–ª–∞–Ω—Å–∏—Ä—É—è –º–µ–∂–¥—É –º–æ—â—å—é, –∑–∞—â–∏—Ç–æ–π –∏ —Å–∫–æ—Ä–æ—Å—Ç—å—é.

---

## üß© 2. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ (Code Structure)

### 2.1. –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã –¥–∞–Ω–Ω—ã—Ö
`src/shared/types/moduleTypes.ts`

```typescript
export type ModuleType = 'armor' | 'engine' | 'sensor' | 'utility' | 'weapon';
export type AttachmentPoint = 'chassis_front' | 'chassis_side' | 'chassis_rear' | 'turret_cheek' | 'turret_roof' | 'barrel_mount';

export interface TankModuleStats {
    // –ú–Ω–æ–∂–∏—Ç–µ–ª–∏ (1.0 = 100%, 1.1 = +10%)
    speedMultiplier?: number;
    damageMultiplier?: number;
    reloadMultiplier?: number;
    armorMultiplier?: number;
    
    // –ü–ª–æ—Å–∫–∏–µ –±–æ–Ω—É—Å—ã
    massAdd?: number; // –ö–≥
    hpAdd?: number;
    
    // –£–Ω–∏–∫–∞–ª—å–Ω—ã–µ —Ñ–ª–∞–≥–∏
    autoRepair?: boolean;
    radarRange?: number;
}

export interface TankModule {
    id: string;
    name: string;
    description: string;
    type: ModuleType;
    rarity: 'common' | 'rare' | 'epic' | 'legendary';
    
    // –í–∏–∑—É–∞–ª
    modelPath: string; // –ü—É—Ç—å –∫ GLB
    attachmentPoint: AttachmentPoint;
    scale: number;
    
    // –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏
    stats: TankModuleStats;
    
    // –≠–∫–æ–Ω–æ–º–∏–∫–∞
    price: number;
}
```

### 2.2. –°–∏—Å—Ç–µ–º–∞ –∫—Ä–µ–ø–ª–µ–Ω–∏—è (Attachment System)
–ü–æ—Å–∫–æ–ª—å–∫—É –Ω–∞—à–∏ —Ç–∞–Ω–∫–∏ –ø—Ä–æ—Ü–µ–¥—É—Ä–Ω—ã–µ (—Å–æ–±—Ä–∞–Ω—ã –∏–∑ —á–∞—Å—Ç–µ–π), —É –Ω–∞—Å –Ω–µ—Ç —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∫–æ—Å—Ç–µ–π.
–ú—ã —Ä–µ–∞–ª–∏–∑—É–µ–º **Virtual Socket System**:

–í `TankController.ts` (–∏ `NetworkPlayerTank.ts`) –¥–æ–±–∞–≤–∏–º `ModuleManager`.
–û–Ω –±—É–¥–µ—Ç –∑–Ω–∞—Ç—å –æ—Ñ—Ñ—Å–µ—Ç—ã (—Å–º–µ—â–µ–Ω–∏—è) –¥–ª—è –∫–∞–∂–¥–æ–π —Ç–æ—á–∫–∏ –∫—Ä–µ–ø–ª–µ–Ω–∏—è –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ —Ü–µ–Ω—Ç—Ä–∞ –∫–æ—Ä–ø—É—Å–∞/–±–∞—à–Ω–∏.

**–ü—Ä–∏–º–µ—Ä –æ—Ñ—Ñ—Å–µ—Ç–æ–≤:**
*   `chassis_front`: `Vector3(0, 0.5, 2.0)` (–°–ø–µ—Ä–µ–¥–∏ –∫–æ—Ä–ø—É—Å–∞)
*   `turret_roof`: `Vector3(0, 1.2, 0)` (–ù–∞ –∫—Ä—ã—à–µ –±–∞—à–Ω–∏)
*   `engine_deck`: `Vector3(0, 0.8, -2.0)` (–°–∑–∞–¥–∏)

### 2.3. –°–µ—Ç–µ–≤–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è
–î–∞–Ω–Ω—ã–µ –æ –Ω–∞–¥–µ—Ç—ã—Ö –º–æ–¥—É–ª—è—Ö –¥–æ–ª–∂–Ω—ã –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å—Å—è –¥—Ä—É–≥–∏–º –∏–≥—Ä–æ–∫–∞–º, —á—Ç–æ–±—ã –æ–Ω–∏ –≤–∏–¥–µ–ª–∏ –∏—Ö –≤–∏–∑—É–∞–ª—å–Ω–æ.
–û–±–Ω–æ–≤–∏–º `PlayerInitData` –∏ `NetworkPlayer`:
```typescript
interface NetworkPlayerData {
    // ...
    modules: string[]; // –ú–∞—Å—Å–∏–≤ ID –º–æ–¥—É–ª–µ–π
}
```

---

## üõ†Ô∏è 3. –°–ø–∏—Å–æ–∫ –ü–µ—Ä–≤—ã—Ö –ú–æ–¥—É–ª–µ–π (MVP)

–ú—ã —Ä–µ–∞–ª–∏–∑—É–µ–º 4 –±–∞–∑–æ–≤—ã—Ö –º–æ–¥—É–ª—è –¥–ª—è —Ç–µ—Å—Ç–∞ –≤—Å–µ—Ö —Å–∏—Å—Ç–µ–º:

### üõ°Ô∏è 1. –ö–æ–º–ø–æ–∑–∏—Ç–Ω–∞—è –ë—Ä–æ–Ω—è (Composite Armor)
*   **–¢–∏–ø**: Armor
*   **–°–ª–æ—Ç**: `chassis_front` (–ù–∞–∫–ª–∞–¥–∫–∞ –Ω–∞ –ª–æ–±)
*   **–≠—Ñ—Ñ–µ–∫—Ç**: +20% HP, +500kg –ú–∞—Å—Å—ã, -5% –°–∫–æ—Ä–æ—Å—Ç–∏.
*   **–í–∏–∑—É–∞–ª**: –ú–∞—Å—Å–∏–≤–Ω–∞—è –ø–ª–∏—Ç–∞ —Å –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–π –∑–∞—â–∏—Ç–æ–π (–∫–≤–∞–¥—Ä–∞—Ç–∏–∫–∏).

### üöÄ 2. –¢—É—Ä–±–æ–Ω–∞–≥–Ω–µ—Ç–∞—Ç–µ–ª—å (Turbocharger)
*   **–¢–∏–ø**: Engine
*   **–°–ª–æ—Ç**: `engine_deck` (–¢—Ä—É–±—ã —Å–∑–∞–¥–∏)
*   **–≠—Ñ—Ñ–µ–∫—Ç**: +15% –°–∫–æ—Ä–æ—Å—Ç–∏, +10% –£—Å–∫–æ—Ä–µ–Ω–∏—è.
*   **–í–∏–∑—É–∞–ª**: –î–≤–æ–π–Ω—ã–µ –≤—ã—Ö–ª–æ–ø–Ω—ã–µ —Ç—Ä—É–±—ã —Å –æ–≥–Ω–µ–º (particle effect).

### üëÅÔ∏è 3. –õ–∞–∑–µ—Ä–Ω—ã–π –î–∞–ª—å–Ω–æ–º–µ—Ä (Laser Rangefinder)
*   **–¢–∏–ø**: Sensor
*   **–°–ª–æ—Ç**: `turret_cheek` (–°–±–æ–∫—É –±–∞—à–Ω–∏)
*   **–≠—Ñ—Ñ–µ–∫—Ç**: -10% –†–∞–∑–±—Ä–æ—Å–∞ (–¢–æ—á–Ω–æ—Å—Ç—å), –í–∏–¥–µ–Ω –ª–∞–∑–µ—Ä–Ω—ã–π –ª—É—á.
*   **–í–∏–∑—É–∞–ª**: –ö–æ—Ä–æ–±–æ—á–∫–∞ —Å –ª–∏–Ω–∑–æ–π –∏ –∫—Ä–∞—Å–Ω—ã–º –ª—É—á–æ–º.

### üíä 4. –ù–∞–Ω–æ-–†–µ–º–∫–æ–º–ø–ª–µ–∫—Ç (Auto-Repair Kit)
*   **–¢–∏–ø**: Utility
*   **–°–ª–æ—Ç**: `chassis_rear` (–Ø—â–∏–∫ —Å –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º–∏)
*   **–≠—Ñ—Ñ–µ–∫—Ç**: –ê–≤—Ç–æ-—Ä–µ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è 1 HP/—Å–µ–∫, –µ—Å–ª–∏ –Ω–µ –ø–æ–ª—É—á–∞–ª —É—Ä–æ–Ω 5 —Å–µ–∫.
*   **–í–∏–∑—É–∞–ª**: –ó–µ–ª–µ–Ω—ã–π –º–∏–≥–∞—é—â–∏–π –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –Ω–∞ —è—â–∏–∫–µ.

---

## üé® 4. –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è (BabylonJS)

### Implementation Plan (Code):
1.  **Loader**: –ó–∞–≥—Ä—É–∂–∞–µ—Ç GLB –º–æ–¥–µ–ª—å –º–æ–¥—É–ª—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ.
2.  **Parenting**:
    *   `moduleMesh.parent = tank.chassisMesh` (–¥–ª—è –±—Ä–æ–Ω–∏/–¥–≤–∏–≥–∞—Ç–µ–ª—è).
    *   `moduleMesh.parent = tank.turretMesh` (–¥–ª—è —Å–µ–Ω—Å–æ—Ä–æ–≤).
3.  **Material**: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–æ—Ç –∂–µ —à–µ–π–¥–µ—Ä/–º–∞—Ç–µ—Ä–∏–∞–ª, —á—Ç–æ –∏ —Ç–∞–Ω–∫, –∏–ª–∏ —Å–≤–æ–π —É–Ω–∏–∫–∞–ª—å–Ω—ã–π (–º–µ—Ç–∞–ª–ª–∏–∫).
4.  **Merging**: –ü—Ä–∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –º–µ—Ä–¥–∂–∏—Ç—å –º–µ—à–∏ –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ (draw calls), –Ω–æ –¥–ª—è –Ω–∞—á–∞–ª–∞ –æ—Å—Ç–∞–≤–∏–º –æ—Ç–¥–µ–ª—å–Ω—ã–º–∏ –¥–ª—è –≥–∏–±–∫–æ—Å—Ç–∏.

---

## üß™ 5. –ü–ª–∞–Ω –†–µ–∞–ª–∏–∑–∞—Ü–∏–∏ (Step-by-Step)

### –≠—Ç–∞–ø 1: –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏ –î–∞–Ω–Ω—ã–µ (Data Layer)
*   [ ] –°–æ–∑–¥–∞—Ç—å `src/shared/types/moduleTypes.ts`.
*   [ ] –°–æ–∑–¥–∞—Ç—å `src/client/config/modulesConfig.ts` (Registry –≤—Å–µ—Ö –º–æ–¥—É–ª–µ–π).
*   [ ] –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª–µ `modules` –≤ `TankStats`.

### –≠—Ç–∞–ø 2: –í–∏–∑—É–∞–ª—å–Ω–∞—è –°–∏—Å—Ç–µ–º–∞ (Visual Layer)
*   [ ] –°–æ–∑–¥–∞—Ç—å –∫–ª–∞—Å—Å `TankModuleManager`.
*   [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –º–µ—Ç–æ–¥ `attachModule(moduleId)`.
*   [ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –æ—Ñ—Ñ—Å–µ—Ç—ã –¥–ª—è `StandardTank`.
*   [ ] –°–æ–∑–¥–∞—Ç—å –ø—Ä–æ—Å—Ç—ã–µ –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä-–º–æ–¥–µ–ª–∏ (Box/Cylinder) —á–µ—Ä–µ–∑ MeshBuilder –¥–ª—è —Ç–µ—Å—Ç–∞.

### –≠—Ç–∞–ø 3: –ì–µ–π–º–ø–ª–µ–π (Gameplay Layer)
*   [ ] –£—á–∏—Ç—ã–≤–∞—Ç—å —Å—Ç–∞—Ç—ã –º–æ–¥—É–ª–µ–π –≤ `TankPhysics` (—Å–∫–æ—Ä–æ—Å—Ç—å/–º–∞—Å—Å–∞).
*   [ ] –£—á–∏—Ç—ã–≤–∞—Ç—å —Å—Ç–∞—Ç—ã –≤ `DamageSystem` (HP/–ë—Ä–æ–Ω—è).
*   [ ] UI: –î–æ–±–∞–≤–∏—Ç—å –≤–∫–ª–∞–¥–∫—É "Modules" –≤ Workshop.

### –≠—Ç–∞–ø 4: –°–µ—Ç—å (Network Layer)
*   [ ] –ü–µ—Ä–µ–¥–∞–≤–∞—Ç—å `modules[]` –ø—Ä–∏ —Å–ø–∞–≤–Ω–µ –∏–≥—Ä–æ–∫–∞.
*   [ ] `NetworkPlayerTank` –¥–æ–ª–∂–µ–Ω —á–∏—Ç–∞—Ç—å —Å–ø–∏—Å–æ–∫ –∏ –≤–µ—à–∞—Ç—å 3D –º–æ–¥–µ–ª–∏ –Ω–∞ —Ç–∞–Ω–∫–∏ –≤—Ä–∞–≥–æ–≤.

---

## ‚ö†Ô∏è –†–∏—Å–∫–∏ –∏ –†–µ—à–µ–Ω–∏—è
1.  **–ö–ª–∏–ø–ø–∏–Ω–≥ (–¢–µ–∫—Å—Ç—É—Ä—ã –≤—Ö–æ–¥—è—Ç –¥—Ä—É–≥ –≤ –¥—Ä—É–≥–∞)**:
    *   *–†–µ—à–µ–Ω–∏–µ*: –û—Ñ—Ñ—Å–µ—Ç—ã –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å –≤—Ä—É—á–Ω—É—é. –°–¥–µ–ª–∞—Ç—å –∏—Ö `adjustments` –≤ –∫–æ–Ω—Ñ–∏–≥–µ –∫–∞–∂–¥–æ–≥–æ –º–æ–¥—É–ª—è.
2.  **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**:
    *   *–†–µ—à–µ–Ω–∏–µ*: –ú–æ–¥–µ–ª–∏ –º–æ–¥—É–ª–µ–π –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å Low Poly (< 500 —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–æ–≤). –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Instancing –µ—Å–ª–∏ –≤–æ–∑–º–æ–∂–Ω–æ.
3.  **–§–∏–∑–∏–∫–∞**:
    *   *–†–µ—à–µ–Ω–∏–µ*: –ú–æ–¥—É–ª–∏ **–Ω–µ –∏–º–µ—é—Ç** —Å–≤–æ–∏—Ö –∫–æ–ª–ª–∏–∑–∏–π (—Ñ–∏–∑–∏—á–µ—Å–∫–∏), –æ–Ω–∏ —Ç–æ–ª—å–∫–æ –≤–∏–∑—É–∞–ª—å–Ω—ã. –•–∏—Ç–±–æ–∫—Å —Ç–∞–Ω–∫–∞ –æ—Å—Ç–∞–µ—Ç—Å—è –ø—Ä–æ—Å—Ç—ã–º Box/Hull.

---

**–ò—Ç–æ–≥**: –≠—Ç–æ –ø—Ä–µ–≤—Ä–∞—Ç–∏—Ç –∏–≥—Ä—É –≤ RPG-–∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä, –≥–¥–µ –∫–∞–∂–¥—ã–π —Ç–∞–Ω–∫ —É–Ω–∏–∫–∞–ª–µ–Ω! üöúüí®
