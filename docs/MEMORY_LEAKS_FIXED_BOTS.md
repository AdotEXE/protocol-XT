# üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ —É—Ç–µ—á–∫–∏ –ø–∞–º—è—Ç–∏ –≤ —Å–∏—Å—Ç–µ–º–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –±–æ—Ç–æ–≤

## –û–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### 1. ‚úÖ BotPerformanceProfiler - setInterval –±–µ–∑ –æ—á–∏—Å—Ç–∫–∏
**–§–∞–π–ª:** `src/client/bots/BotPerformanceProfiler.ts`

**–ü—Ä–æ–±–ª–µ–º–∞:**
- `setInterval` —Å–æ–∑–¥–∞–≤–∞–ª—Å—è –≤ `createUI()` –±–µ–∑ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è ID
- –ò–Ω—Ç–µ—Ä–≤–∞–ª –ø—Ä–æ–¥–æ–ª–∂–∞–ª —Ä–∞–±–æ—Ç–∞—Ç—å –¥–∞–∂–µ –ø–æ—Å–ª–µ –∑–∞–∫—Ä—ã—Ç–∏—è UI
- –£—Ç–µ—á–∫–∞ –ø–∞–º—è—Ç–∏ –∏ –ª–∏—à–Ω–∏–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**
- –î–æ–±–∞–≤–ª–µ–Ω–æ —Å–≤–æ–π—Å—Ç–≤–æ `updateTimer` –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è ID –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞
- –î–æ–±–∞–≤–ª–µ–Ω—ã –º–µ—Ç–æ–¥—ã `startUpdates()` –∏ `stopUpdates()`
- –ò–Ω—Ç–µ—Ä–≤–∞–ª –æ—á–∏—â–∞–µ—Ç—Å—è –≤ `hide()` –∏ `dispose()`

### 2. ‚úÖ BotPerformanceProfiler - Observable –±–µ–∑ —É–¥–∞–ª–µ–Ω–∏—è
**–§–∞–π–ª:** `src/client/bots/BotPerformanceProfiler.ts`

**–ü—Ä–æ–±–ª–µ–º–∞:**
- `onPointerClickObservable.add()` —Å–æ–∑–¥–∞–≤–∞–ª –Ω–∞–±–ª—é–¥–∞—Ç–µ–ª–∏ –±–µ–∑ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Å—Å—ã–ª–æ–∫
- –ù–∞–±–ª—é–¥–∞—Ç–µ–ª–∏ –Ω–µ —É–¥–∞–ª—è–ª–∏—Å—å –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ UI
- –£—Ç–µ—á–∫–∞ –ø–∞–º—è—Ç–∏ –∏ –ª–∏—à–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–æ–±—ã—Ç–∏–π

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**
- –î–æ–±–∞–≤–ª–µ–Ω–æ —Å–≤–æ–π—Å—Ç–≤–æ `buttonObservers` –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Å—Å—ã–ª–æ–∫ –Ω–∞ –Ω–∞–±–ª—é–¥–∞—Ç–µ–ª–∏
- –í—Å–µ –Ω–∞–±–ª—é–¥–∞—Ç–µ–ª–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏
- –ù–∞–±–ª—é–¥–∞—Ç–µ–ª–∏ —É–¥–∞–ª—è—é—Ç—Å—è –≤ `hide()` —á–µ—Ä–µ–∑ `remove()`

### 3. ‚úÖ BotPerformanceUI - Observable –±–µ–∑ —É–¥–∞–ª–µ–Ω–∏—è
**–§–∞–π–ª:** `src/client/bots/BotPerformanceUI.ts`

**–ü—Ä–æ–±–ª–µ–º–∞:**
- `onPointerClickObservable.add()` –¥–ª—è –∫–Ω–æ–ø–æ–∫ –±–µ–∑ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Å—Å—ã–ª–æ–∫
- –ù–∞–±–ª—é–¥–∞—Ç–µ–ª–∏ –Ω–µ —É–¥–∞–ª—è–ª–∏—Å—å –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ UI
- –£—Ç–µ—á–∫–∞ –ø–∞–º—è—Ç–∏

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**
- –î–æ–±–∞–≤–ª–µ–Ω–æ —Å–≤–æ–π—Å—Ç–≤–æ `buttonObservers` –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Å—Å—ã–ª–æ–∫
- –í—Å–µ –Ω–∞–±–ª—é–¥–∞—Ç–µ–ª–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∫–Ω–æ–ø–æ–∫
- –ù–∞–±–ª—é–¥–∞—Ç–µ–ª–∏ —É–¥–∞–ª—è—é—Ç—Å—è –≤ `hide()`

### 4. ‚úÖ BotPerformanceSettingsUI - Observable –±–µ–∑ —É–¥–∞–ª–µ–Ω–∏—è
**–§–∞–π–ª:** `src/client/bots/BotPerformanceSettingsUI.ts`

**–ü—Ä–æ–±–ª–µ–º–∞:**
- `onValueChangedObservable.add()` –∏ `onPointerClickObservable.add()` –±–µ–∑ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Å—Å—ã–ª–æ–∫
- –ù–∞–±–ª—é–¥–∞—Ç–µ–ª–∏ –Ω–µ —É–¥–∞–ª—è–ª–∏—Å—å –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ UI
- –£—Ç–µ—á–∫–∞ –ø–∞–º—è—Ç–∏

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**
- –î–æ–±–∞–≤–ª–µ–Ω–æ —Å–≤–æ–π—Å—Ç–≤–æ `observers` –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Å—Å—ã–ª–æ–∫
- –í—Å–µ –Ω–∞–±–ª—é–¥–∞—Ç–µ–ª–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —ç–ª–µ–º–µ–Ω—Ç–æ–≤
- –ù–∞–±–ª—é–¥–∞—Ç–µ–ª–∏ —É–¥–∞–ª—è—é—Ç—Å—è –≤ `hide()` —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π —Ç–∏–ø–∞ Observable

### 5. ‚úÖ BotMetricsCollector - setInterval –±–µ–∑ –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –æ—á–∏—Å—Ç–∫–∏
**–§–∞–π–ª:** `src/client/bots/BotMetricsCollector.ts`

**–ü—Ä–æ–±–ª–µ–º–∞:**
- `setInterval` –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω—è–ª—Å—è, –Ω–æ `onDispose` –º–æ–≥ –Ω–µ –≤—ã–∑—ã–≤–∞—Ç—å—Å—è
- –ò–Ω—Ç–µ—Ä–≤–∞–ª –º–æ–≥ –ø—Ä–æ–¥–æ–ª–∂–∞—Ç—å —Ä–∞–±–æ—Ç–∞—Ç—å –ø–æ—Å–ª–µ —É–¥–∞–ª–µ–Ω–∏—è –±–æ—Ç–∞
- –£—Ç–µ—á–∫–∞ –ø–∞–º—è—Ç–∏

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**
- –ò–Ω—Ç–µ—Ä–≤–∞–ª —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ `_metricsStateCheckInterval`
- –î–æ–±–∞–≤–ª–µ–Ω –ø–µ—Ä–µ—Ö–≤–∞—Ç `dispose()` –º–µ—Ç–æ–¥–∞ EnemyTank
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ `onDeathObservable` –¥–ª—è –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –æ—á–∏—Å—Ç–∫–∏
- –ò–Ω—Ç–µ—Ä–≤–∞–ª –æ—á–∏—â–∞–µ—Ç—Å—è –≤ –æ–±–æ–∏—Ö —Å–ª—É—á–∞—è—Ö

### 6. ‚úÖ BotPerformanceMonitor - –Ω–µ–ø–æ–ª–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ –º–µ—Ç—Ä–∏–∫
**–§–∞–π–ª:** `src/client/bots/BotPerformanceMonitor.ts`

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ú–µ—Ç—Ä–∏–∫–∏ —É–¥–∞–ª—ë–Ω–Ω—ã—Ö –±–æ—Ç–æ–≤ –Ω–µ –æ—á–∏—â–∞–ª–∏—Å—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- –ò—Å—Ç–æ—Ä–∏—è –≤—Ä–µ–º–µ–Ω–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –º–æ–≥–ª–∞ —Ä–∞—Å—Ç–∏ –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ
- –£—Ç–µ—á–∫–∞ –ø–∞–º—è—Ç–∏ –ø—Ä–∏ –¥–ª–∏—Ç–µ–ª—å–Ω–æ–π –∏–≥—Ä–µ

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**
- –î–æ–±–∞–≤–ª–µ–Ω –º–µ—Ç–æ–¥ `updateBotsList()` –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ —Å–ø–∏—Å–∫–∞ –±–æ—Ç–æ–≤
- –ú–µ—Ç–æ–¥ `clearBotMetrics()` —Ç–µ–ø–µ—Ä—å –æ—á–∏—â–∞–µ—Ç –∏—Å—Ç–æ—Ä–∏—é –≤—Ä–µ–º–µ–Ω–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
- –í `dispose()` –æ—á–∏—â–∞—é—Ç—Å—è –≤—Å–µ —Å—Å—ã–ª–∫–∏ –Ω–∞ –±–æ—Ç–æ–≤

## –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:**
- 6 –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã—Ö —É—Ç–µ—á–µ–∫ –ø–∞–º—è—Ç–∏
- 4 –ø—Ä–æ–±–ª–µ–º—ã —Å Observable –±–µ–∑ —É–¥–∞–ª–µ–Ω–∏—è
- 2 –ø—Ä–æ–±–ª–µ–º—ã —Å setInterval –±–µ–∑ –æ—á–∏—Å—Ç–∫–∏
- 1 –ø—Ä–æ–±–ª–µ–º–∞ —Å –Ω–µ–ø–æ–ª–Ω–æ–π –æ—á–∏—Å—Ç–∫–æ–π –º–µ—Ç—Ä–∏–∫

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è –±—É–¥—É—â–µ–≥–æ –∫–æ–¥–∞

### 1. –í—Å–µ–≥–¥–∞ —Å–æ—Ö—Ä–∞–Ω—è–π—Ç–µ ID –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–≤:

```typescript
private updateTimer: NodeJS.Timeout | null = null;

this.updateTimer = setInterval(() => {
    // ...
}, 1000);

// –í dispose/hide:
if (this.updateTimer) {
    clearInterval(this.updateTimer);
    this.updateTimer = null;
}
```

### 2. –í—Å–µ–≥–¥–∞ —Å–æ—Ö—Ä–∞–Ω—è–π—Ç–µ —Å—Å—ã–ª–∫–∏ –Ω–∞ Observable –Ω–∞–±–ª—é–¥–∞—Ç–µ–ª–∏:

```typescript
private observers: Array<{ control: Control; observer: any }> = [];

const observer = button.onPointerClickObservable.add(() => {
    // ...
});
this.observers.push({ control: button, observer });

// –í dispose/hide:
this.observers.forEach(({ control, observer }) => {
    try {
        if ((control as any).onPointerClickObservable) {
            (control as any).onPointerClickObservable.remove(observer);
        }
    } catch (e) {
        // –ò–≥–Ω–æ—Ä–∏—Ä—É–µ–º –æ—à–∏–±–∫–∏
    }
});
this.observers = [];
```

### 3. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–µ—Ä–µ—Ö–≤–∞—Ç dispose –¥–ª—è –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –æ—á–∏—Å—Ç–∫–∏:

```typescript
const originalDispose = object.dispose;
object.dispose = function() {
    // –û—á–∏—Å—Ç–∫–∞ —Ä–µ—Å—É—Ä—Å–æ–≤
    clearInterval(this.timer);
    
    // –í—ã–∑–æ–≤ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–≥–æ dispose
    if (originalDispose) {
        originalDispose.call(this);
    }
};
```

### 4. –ü–æ–¥–ø–∏—Å—ã–≤–∞–π—Ç–µ—Å—å –Ω–∞ —Å–æ–±—ã—Ç–∏—è —Å–º–µ—Ä—Ç–∏ –¥–ª—è –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –æ—á–∏—Å—Ç–∫–∏:

```typescript
if (object.onDeathObservable) {
    object.onDeathObservable.addOnce(() => {
        // –û—á–∏—Å—Ç–∫–∞ —Ä–µ—Å—É—Ä—Å–æ–≤
        clearInterval(timer);
    });
}
```

## –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —É—Ç–µ—á–∫–∏ –ø–∞–º—è—Ç–∏

–î–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ —É—Ç–µ—á–∫–∏ –ø–∞–º—è—Ç–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ Chrome DevTools:

1. –û—Ç–∫—Ä–æ–π—Ç–µ DevTools ‚Üí Memory
2. –°–¥–µ–ª–∞–π—Ç–µ Heap Snapshot –¥–æ –Ω–∞—á–∞–ª–∞ –∏–≥—Ä—ã
3. –ò–≥—Ä–∞–π—Ç–µ –Ω–µ–∫–æ—Ç–æ—Ä–æ–µ –≤—Ä–µ–º—è
4. –°–¥–µ–ª–∞–π—Ç–µ Heap Snapshot –ø–æ—Å–ª–µ –∏–≥—Ä—ã
5. –°—Ä–∞–≤–Ω–∏—Ç–µ —Ä–∞–∑–º–µ—Ä—ã - –Ω–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ–≥–æ —Ä–æ—Å—Ç–∞

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–í—Å–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã:
- ‚úÖ UI –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è –±–µ–∑ —É—Ç–µ—á–µ–∫
- ‚úÖ –ò–Ω—Ç–µ—Ä–≤–∞–ª—ã –æ—á–∏—â–∞—é—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ
- ‚úÖ Observable –Ω–∞–±–ª—é–¥–∞—Ç–µ–ª–∏ —É–¥–∞–ª—è—é—Ç—Å—è
- ‚úÖ –ú–µ—Ç—Ä–∏–∫–∏ –æ—á–∏—â–∞—é—Ç—Å—è –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –±–æ—Ç–æ–≤
- ‚úÖ –ù–µ—Ç —Ä–æ—Å—Ç–∞ –ø–∞–º—è—Ç–∏ –ø—Ä–∏ –¥–ª–∏—Ç–µ–ª—å–Ω–æ–π –∏–≥—Ä–µ

