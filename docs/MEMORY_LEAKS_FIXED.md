# üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ —É—Ç–µ—á–∫–∏ –ø–∞–º—è—Ç–∏

## –û–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### 1. ‚úÖ ChatSystem - setInterval –±–µ–∑ –æ—á–∏—Å—Ç–∫–∏
**–§–∞–π–ª:** `src/client/chatSystem.ts`

**–ü—Ä–æ–±–ª–µ–º–∞:**
- `startCleanupTimer()` —Å–æ–∑–¥–∞–≤–∞–ª `setInterval` –±–µ–∑ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è ID
- –ò–Ω—Ç–µ—Ä–≤–∞–ª –ø—Ä–æ–¥–æ–ª–∂–∞–ª —Ä–∞–±–æ—Ç–∞—Ç—å –¥–∞–∂–µ –ø–æ—Å–ª–µ —É–Ω–∏—á—Ç–æ–∂–µ–Ω–∏—è ChatSystem
- –£—Ç–µ—á–∫–∞ –ø–∞–º—è—Ç–∏ –∏ –ª–∏—à–Ω–∏–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**
- –î–æ–±–∞–≤–ª–µ–Ω–æ —Å–≤–æ–π—Å—Ç–≤–æ `cleanupTimerInterval` –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è ID –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞
- –î–æ–±–∞–≤–ª–µ–Ω –º–µ—Ç–æ–¥ `stopCleanupTimer()` –¥–ª—è –æ—á–∏—Å—Ç–∫–∏
- –ò–Ω—Ç–µ—Ä–≤–∞–ª –æ—á–∏—â–∞–µ—Ç—Å—è –≤ `dispose()`

### 2. ‚úÖ ChatSystem - –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π –Ω–∞ document
**–§–∞–π–ª:** `src/client/chatSystem.ts`

**–ü—Ä–æ–±–ª–µ–º–∞:**
- `addEventListener("mousemove")` –∏ `addEventListener("mouseup")` –Ω–∞ `document`
- –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –Ω–µ —É–¥–∞–ª—è–ª–∏—Å—å –ø—Ä–∏ dispose
- –£—Ç–µ—á–∫–∞ –ø–∞–º—è—Ç–∏ –∏ –ª–∏—à–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–æ–±—ã—Ç–∏–π

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**
- –î–æ–±–∞–≤–ª–µ–Ω—ã —Å–≤–æ–π—Å—Ç–≤–∞ `mouseMoveHandler` –∏ `mouseUpHandler` –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Å—Å—ã–ª–æ–∫
- –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —É–¥–∞–ª—è—é—Ç—Å—è –≤ `dispose()` —á–µ—Ä–µ–∑ `removeEventListener()`

### 3. ‚úÖ ChatSystem - –Ω–µ–ø–æ–ª–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ —Ä–µ—Å—É—Ä—Å–æ–≤
**–§–∞–π–ª:** `src/client/chatSystem.ts`

**–ü—Ä–æ–±–ª–µ–º–∞:**
- `dispose()` –º–µ—Ç–æ–¥ –±—ã–ª –Ω–µ–ø–æ–ª–Ω—ã–º
- –ù–µ –æ—á–∏—â–∞–ª–∏—Å—å –≤—Å–µ —Å—Å—ã–ª–∫–∏ –∏ —ç–ª–µ–º–µ–Ω—Ç—ã

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–ª–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ –≤—Å–µ—Ö —Ä–µ—Å—É—Ä—Å–æ–≤:
  - –ò–Ω—Ç–µ—Ä–≤–∞–ª—ã (cleanup timer, voice chat updates)
  - Event listeners –Ω–∞ document
  - HTML —ç–ª–µ–º–µ–Ω—Ç—ã –∏ –∏—Ö —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ
  - GUI —ç–ª–µ–º–µ–Ω—Ç—ã (Babylon.js)
  - –°—Å—ã–ª–∫–∏ –Ω–∞ –æ–±—ä–µ–∫—Ç—ã
  - Map –∏ Set –∫–æ–ª–ª–µ–∫—Ü–∏–∏

## –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

**–î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
- `setInterval/setTimeout`: 1076 –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–π
- `clearInterval/clearTimeout`: 122 –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
- **–î–∏—Å–±–∞–ª–∞–Ω—Å: ~954 –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã—Ö —É—Ç–µ—á–µ–∫**

**–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
- ChatSystem —Ç–µ–ø–µ—Ä—å –ø–æ–ª–Ω–æ—Å—Ç—å—é –æ—á–∏—â–∞–µ—Ç –≤—Å–µ —Ä–µ—Å—É—Ä—Å—ã
- –í—Å–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç ID –¥–ª—è –ø–æ—Å–ª–µ–¥—É—é—â–µ–π –æ—á–∏—Å—Ç–∫–∏
- –í—Å–µ event listeners —É–¥–∞–ª—è—é—Ç—Å—è –ø—Ä–∏ dispose

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –î–ª—è –±—É–¥—É—â–µ–≥–æ –∫–æ–¥–∞:

1. **–í—Å–µ–≥–¥–∞ —Å–æ—Ö—Ä–∞–Ω—è–π—Ç–µ ID –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–≤:**
```typescript
private intervalId: NodeJS.Timeout | null = null;

this.intervalId = setInterval(() => {
    // ...
}, 1000);

// –í dispose:
if (this.intervalId) {
    clearInterval(this.intervalId);
    this.intervalId = null;
}
```

2. **–í—Å–µ–≥–¥–∞ —É–¥–∞–ª—è–π—Ç–µ event listeners:**
```typescript
private handler: ((e: Event) => void) | null = null;

this.handler = (e) => { /* ... */ };
document.addEventListener("click", this.handler);

// –í dispose:
if (this.handler) {
    document.removeEventListener("click", this.handler);
    this.handler = null;
}
```

3. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ TimerManager –¥–ª—è –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–≤:**
```typescript
import { timerManager } from "./optimization/TimerManager";

const intervalId = timerManager.setInterval(() => {
    // ...
}, 1000);

// –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—á–∏—â–∞–µ—Ç—Å—è –ø—Ä–∏ dispose —Å–∏—Å—Ç–µ–º—ã
```

4. **–†–µ–∞–ª–∏–∑—É–π—Ç–µ dispose() –¥–ª—è –≤—Å–µ—Ö –∫–ª–∞—Å—Å–æ–≤ —Å —Ä–µ—Å—É—Ä—Å–∞–º–∏:**
```typescript
dispose(): void {
    // 1. –û—á–∏—Å—Ç–∏—Ç—å –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã
    // 2. –£–¥–∞–ª–∏—Ç—å event listeners
    // 3. –û—á–∏—Å—Ç–∏—Ç—å –∫–æ–ª–ª–µ–∫—Ü–∏–∏ (Map, Set, Array)
    // 4. Dispose Babylon.js —Ä–µ—Å—É—Ä—Å—ã
    // 5. –û—á–∏—Å—Ç–∏—Ç—å —Å—Å—ã–ª–∫–∏ (null)
}
```

## –ü—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

‚úÖ **ChatSystem** - –ø–æ–ª–Ω–æ—Å—Ç—å—é –∏—Å–ø—Ä–∞–≤–ª–µ–Ω
‚úÖ **NetworkMenu** - –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ—á–∏—â–∞–µ—Ç –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã –≤ `hide()`
‚úÖ **VoiceChatManager** - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—É—é –æ—á–∏—Å—Ç–∫—É
‚úÖ **HotkeyManager** - –∏–º–µ–µ—Ç `cleanup()` –º–µ—Ç–æ–¥

## –û—Å—Ç–∞–ª–æ—Å—å –ø—Ä–æ–≤–µ—Ä–∏—Ç—å

‚ö†Ô∏è –î—Ä—É–≥–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å –±–æ–ª—å—à–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º `setInterval/setTimeout`:
- `menu.ts` (218 –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–π)
- `game.ts` (58 –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–π)
- `tankController.ts` (55 –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–π)
- `hud.ts` (41 –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ)
- `multiplayer.ts` (9 –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–π)

–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –ø—Ä–æ–≤–µ—Å—Ç–∏ –∞—É–¥–∏—Ç –≤—Å–µ—Ö —ç—Ç–∏—Ö —Ñ–∞–π–ª–æ–≤ –Ω–∞ –ø—Ä–µ–¥–º–µ—Ç —É—Ç–µ—á–µ–∫ –ø–∞–º—è—Ç–∏.

